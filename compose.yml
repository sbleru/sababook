services:
  saba-dev:
    build: .
    container_name: saba-browser-dev
    volumes:
      # ソースコードのマウント
      - .:/workspace
      # Cargoキャッシュの永続化
      - cargo-cache:/root/.cargo/registry
      - cargo-target-cache:/workspace/target
    ports:
      # VNCポート
      - "5900:5900"
      # noVNCポート（Webブラウザでアクセス）
      - "6080:6080"
    environment:
      - DISPLAY=:1
      - VNC_RESOLUTION=1280x800
    # コンテナを起動し続ける
    tty: true
    stdin_open: true
    # 特権モードでQEMUを実行するため
    privileged: true

volumes:
  cargo-cache:
  cargo-target-cache:
